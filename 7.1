# Zad. 7.1

import unittest
from math import gcd

class Fractions:

    def __init__(self, licznik, mianownik):
        self.x = licznik
        self.y = mianownik

        if mianownik == 0:
            raise ValueError("Mianownik nie może być zerem")
        
        


    def __str__(self):
        return f"{self.x}/{self.y}"
    
    def __repr__(self):
        return f"Frac({self.x}, {self.y})"
    
    """Skracanie ułamków"""
    def skracanie(self):

        if self.y == 0:
            raise ValueError("Mianownik nie może być zerem")

        if self.y < 0:
            self.x, self.y = -self.x, - self.y

        g = gcd(self.x, self.y)
        self.x = self.x // g
        self.y = self.y // g

    """Sumowanie ułamków"""
    def __add__(self, other):

        if isinstance(other, int):
            other = Fractions(other, 1)

        elif isinstance(other, float):
            a, b = other.as_integer_ratio()
            other = Fractions(a, b)

        suma = Fractions(self.x * other.y + self.y * other.x, self.y * other.y)
        suma.skracanie()
        return suma

    """Odejmowanie ułamków"""
    def __sub__(self, other):

        if isinstance(other, int):
            other = Fractions(other, 1)

        elif isinstance(other, float):
            a, b = other.as_integer_ratio()
            other = Fractions(a, b)

        roznica = Fractions(self.x * other.y - self.y * other.x, self.y * other.y)
        roznica.skracanie()
        return roznica
    """Mnożenie"""
    def __mul__(self, other):

        if isinstance(other, int):
            other = Fractions(other, 1)

        elif isinstance(other, float):
            a, b = other.as_integer_ratio()
            other = Fractions(a, b)

        iloczyn = Fractions(self.x * other.x, self.y * other.y)
        iloczyn.skracanie()
        return iloczyn

    """Dzielenie"""
    def __truediv__(self, other):

        if isinstance(other, int):
            other = Fractions(other, 1)

        elif isinstance(other, float):
            a, b = other.as_integer_ratio()
            other = Fractions(a, b)

        iloraz = Fractions(self.x * other.y, self.y * other.x)
        iloraz.skracanie()
        return iloraz

    """Sprawdzenie znaku"""
    def znak(self):
        return self.x * self.y > 0

    """Sprawdzanie zera"""
    def zero(self):
        return self.x == 0

    """Porównywanie"""
    def __eq__(self, other):
        return self.x * other.y == self.y * other.x

    def __ne__(self, other):
        return not self == other
    
    """Konwersja do float"""
    def __float__(self):
        return self.x / self.y

class TestFractions(unittest.TestCase):
    def test_mianownik(self):
        with self.assertRaises(ValueError):
            a = Fractions(1, 0)
            b = Fractions(2, 3)
            Fractions.__add__(a, b)

    def test_dodawanie(self):
        self.assertEqual(Fractions.__add__(Fractions(1, 2), Fractions(1,3)), Fractions(5,6))

    def test_odejmowanie(self):
        self.assertEqual(Fractions.__sub__(Fractions(3, 4), Fractions(1, 2)), Fractions(1, 4))

    def test_mnożenie(self):
        self.assertEqual(Fractions.__mul__(Fractions(2, 3), Fractions(3, 4)), Fractions(1, 2))

    def test_dzielenie(self):
        self.assertEqual(Fractions.__truediv__(Fractions(1, 2), Fractions(3, 4)), Fractions(2, 3))

    def test_znak(self):
        self.assertTrue(Fractions.znak(Fractions(4, 5)))
        self.assertFalse(Fractions.znak(Fractions(-1, 8)))

    def test_zero(self):
        self.assertTrue(Fractions.zero(Fractions(0,3)))
        self.assertFalse(Fractions.zero(Fractions(8, 9)))

    def test_porównaj(self):
        self.assertTrue(Fractions(1, 2) == Fractions(2, 4))
        self.assertFalse(Fractions(1, 3) == Fractions(1, 2))
        self.assertTrue(Fractions(3, 2) != Fractions(1, 2))

    def test_konwersja(self):
        self.assertAlmostEqual(Fractions.__float__(Fractions(1, 2)), 0.5)

    def test_add_with_int(self):
        self.assertEqual(Fractions(1, 2) + 2, Fractions(5, 2))

    def test_add_with_float(self):
        self.assertEqual(Fractions(1, 2) + 0.25, Fractions(3, 4))
        
if __name__ == '__main__':
    unittest.main()
